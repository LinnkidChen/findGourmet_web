{"remainingRequest":"/Users/tongchen/Downloads/findGourmet_web/findGourmet/front_end/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tongchen/Downloads/findGourmet_web/findGourmet/front_end/src/components/release_convene/Convene.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tongchen/Downloads/findGourmet_web/findGourmet/front_end/src/components/release_convene/Convene.vue","mtime":1608238814000},{"path":"/Users/tongchen/Downloads/findGourmet_web/findGourmet/front_end/node_modules/cache-loader/dist/cjs.js","mtime":1670653172899},{"path":"/Users/tongchen/Downloads/findGourmet_web/findGourmet/front_end/node_modules/babel-loader/lib/index.js","mtime":1670653173065},{"path":"/Users/tongchen/Downloads/findGourmet_web/findGourmet/front_end/node_modules/cache-loader/dist/cjs.js","mtime":1670653172899},{"path":"/Users/tongchen/Downloads/findGourmet_web/findGourmet/front_end/node_modules/vue-loader/lib/index.js","mtime":1670653169666}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY2FsbE9wdGlvbjogW10sIC8vIOWPrOmbhuS7pOexu+Wei+WIl+ihqAogICAgICAgICAgICBjYWxsRm9ybTogewogICAgICAgICAgICAgICAgdXNlcklkOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmlkLAogICAgICAgICAgICAgICAgdHlwZU5hbWU6ICcnLAogICAgICAgICAgICAgICAgbmFtZTogJycsCiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgICAgICAgICAgICBlbmRUaW1lOiAnJywKICAgICAgICAgICAgICAgIHBlb3BsZUNvdW50OiAzLAogICAgICAgICAgICAgICAgdHlwZUlkOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICBleHBpcmVUaW1lT3B0aW9uOiB7CiAgICAgICAgICAgICAgICBkaXNhYmxlZERhdGUoZGF0ZSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRlLmdldFRpbWUoKSA8PSBEYXRlLm5vdygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBjYWxsUnVsZXM6IHsKICAgICAgICAgICAgICAgIHR5cGVOYW1lOiBbCiAgICAgICAgICAgICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeWPrOmbhuS7pOexu+WeiycsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIG5hbWU6IFsKICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5Y+s6ZuG5Luk5ZCN56ewJywgdHJpZ2dlcjogJ2JsdXInIH0sCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFsKICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5Y+s6ZuG5Luk5o+P6L+wJywgdHJpZ2dlcjogJ2JsdXInIH0sCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgcGVvcGxlQ291bnQ6IFsKICAgICAgICAgICAgICAgICAgICB7IHZhbGlkYXRvcjogdGhpcy5jaGVja19jbnQsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIGVuZFRpbWU6IFsKICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oup5Y+s6ZuG5Luk57uT5p2f5pe26Ze0JywgdHJpZ2dlcjogJ2JsdXInfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgICAgdGhpcy4kaHR0cC5nZXQoIi9jYWxsL2dldENhbGxUeXBlIiwgewogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDIwMCkgewogICAgICAgICAgICAgICAgdGhhdC5jYWxsT3B0aW9uID0gcmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGF0LiRtZXNzYWdlKHtzaG93Q2xvc2U6IHRydWUsIG1lc3NhZ2U6IHJlc3BvbnNlLmRhdGEubWVzc2FnZSwgdHlwZTogJ3dhcm5pbmcnfSkKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgICAgICB0aGF0LiRtZXNzYWdlKHtzaG93Q2xvc2U6IHRydWUsIG1lc3NhZ2U6ICLor7fmsYLplJnor68iLCB0eXBlOiAnZXJyb3InfSkKICAgICAgICB9KQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICAvLyDmo4Dmn6Xlj6zpm4bkurrmlbAKICAgICAgICBjaGVja19jbnQocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSB7CiAgICAgICAgICAgIGlmIChTdHJpbmcodmFsdWUpLnRyaW0oKSA9PSAnJykgewogICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcign6K+36L6T5YWl5Y+s6ZuG5Lq65pWwJykpCiAgICAgICAgICAgIH0gZWxzZSBpZiAoTnVtYmVyKHZhbHVlKSA8PSAwIHx8IE51bWJlcih2YWx1ZSkgPj0xMDEpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ+WPrOmbhuS6uuaVsOW/hemhu+WcqDF+MTAw5YaFJykpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzaG93TWVzc2FnZShlKSB7CiAgICAgICAgICAgIGxldCBvYmogPSB7fTsKICAgICAgICAgICAgb2JqID0gdGhpcy5jYWxsT3B0aW9uLmZpbmQoKGl0ZW0pPT57IC8v6L+Z6YeM55qEY2FsbE9wdGlvbuWwseaYr+S4iumdoumBjeWOhueahOaVsOaNrua6kAogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uY2FsbFR5cGVJZCA9PT0gZTsgICAgIC8v562b6YCJ5Ye65Yy56YWN5pWw5o2uCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmNhbGxGb3JtLnR5cGVOYW1lID0gb2JqLmNhbGxUeXBlTmFtZSAgLy8gbGFiZWwKICAgICAgICAgICAgdGhpcy5jYWxsRm9ybS50eXBlSWQgPSBlICAgICAgICAgICAgLy8gdmFsdWUKICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoYW5nZU9wdGlvbicsIGUsIG9iai5jYWxsVHlwZU5hbWUpCiAgICAgICAgfSwKICAgICAgICAvLyDlj5HluIPlj6zpm4bku6QKICAgICAgICBzdWJtaXQoKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2FsbEZvcm0uZW5kVGltZSkKICAgICAgICAgICAgdGhpcy4kcmVmcy5jYWxsRm9ybVJlZi52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICAgICAgICAgIGlmICghdmFsaWQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfovpPlhaXmlbDmja7ml6DmlYgnLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsCiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICB2YXIgY29uZmlnID0gewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgICAgICAgICAgICAgIHVybDogJy9jYWxsL2FkZCcsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAKICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSAKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGRhdGEgOiB0aGlzLmNhbGxGb3JtCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgICAgICAgICAgICB0aGlzLiRodHRwKGNvbmZpZykKICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEsIHRoYXQuY2FsbEZvcm0udHlwZUlkLCB0aGF0LmNhbGxGb3JtLnR5cGVOYW1lKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRyb3V0ZXIucHVzaCgnL215Y29udmVuZScpCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVOYXYnLCAnL215Y29udmVuZScpCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJHN0b3JlLmNvbW1pdCgnY2FsbC9zZXRfYWN0aXZlTmF2JywgJy9teWNvbnZlbmUnKQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRtZXNzYWdlKHsgc2hvd0Nsb3NlOiB0cnVlLCBtZXNzYWdlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UsdHlwZTogJ3N1Y2Nlc3MnfSkKICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC51cGxvYWRWaXNpYmxlID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJG1lc3NhZ2Uoe3Nob3dDbG9zZTogdHJ1ZSwgbWVzc2FnZTpyZXNwb25zZS5kYXRhLm1lc3NhZ2UsIHR5cGU6ICdlcnJvcid9KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGF0LiRtZXNzYWdlKHtzaG93Q2xvc2U6IHRydWUsIG1lc3NhZ2U6J+ivt+axgumUmeivrycsIHR5cGU6ICdlcnJvcid9KQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICAvLyDph43nva4KICAgICAgICByZXNldCgpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ3Jlc2V0IGNvbnZlbmUgZm9ybScpCiAgICAgICAgICAgIHRoaXMuJHJlZnMuY2FsbEZvcm1SZWYucmVzZXRGaWVsZHMoKQogICAgICAgIH0sCiAgICB9CiAgICAKfQo="},{"version":3,"sources":["Convene.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Convene.vue","sourceRoot":"src/components/release_convene","sourcesContent":["<template>\n    <div>\n        <!-- 面包屑 -->\n        <el-breadcrumb separator-class=\"el-icon-arrow-right\">\n            <el-breadcrumb-item :to=\"{ path: '/welcome' }\">首页</el-breadcrumb-item>\n            <el-breadcrumb-item>令主</el-breadcrumb-item>\n            <el-breadcrumb-item>发布召集令</el-breadcrumb-item>\n        </el-breadcrumb>\n        <!-- 发布召集令主体 -->\n        <h2>填写相关信息</h2>\n        <el-form :model=\"callForm\" :rules=\"callRules\" ref=\"callFormRef\" label-width=\"120px\">\n            <el-form-item label=\"召集令类型\" prop=\"typeName\">\n                <el-select v-model=\"callForm.typeId\" placeholder=\"请选择召集令类型\" @change=\"showMessage($event)\">\n                    <el-option\n                        v-for=\"item in callOption\"\n                        :key=\"item.callTypeId\"\n                        :label=\"item.callTypeName\"\n                        :value=\"item.callTypeId\"\n                    >\n                    </el-option>\n                </el-select>\n            </el-form-item>\n            <el-form-item label=\"召集令名称\" prop=\"name\">\n                <el-input v-model=\"callForm.name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"召集令描述\" prop=\"description\">\n                <el-input type=\"textarea\" v-model=\"callForm.description\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"召集人数\" prop=\"peopleCount\">\n                <el-input v-model=\"callForm.peopleCount\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"召集结束日期\" required>\n                <el-col :span=\"11\">\n                <el-form-item prop=\"endTime\">\n                    <el-date-picker type=\"datetime\" placeholder=\"选择日期\" v-model=\"callForm.endTime\" value-format=\"yyyy-MM-dd HH:mm:ss\" :picker-options=\"expireTimeOption\" style=\"width: 100%;\"></el-date-picker>\n                </el-form-item>\n                </el-col>\n            </el-form-item>\n            <!-- 提交按钮 -->\n            <el-form-item>\n                <el-button type=\"primary\" @click=\"submit()\">发布</el-button>\n                <el-button type=\"info\" @click=\"reset()\">重置</el-button>\n            </el-form-item>\n        </el-form>\n    </div>\n</template>\n\n<script>\nexport default {\n    data() {\n        return {\n            callOption: [], // 召集令类型列表\n            callForm: {\n                userId: this.$store.state.user.id,\n                typeName: '',\n                name: '',\n                description: '',\n                endTime: '',\n                peopleCount: 3,\n                typeId: ''\n            },\n            expireTimeOption: {\n                disabledDate(date) {\n                    return date.getTime() <= Date.now();\n                }\n            },\n            callRules: {\n                typeName: [\n                    { required: true, message: '请选择召集令类型', trigger: 'blur' },\n                ],\n                name: [\n                    { required: true, message: '请输入召集令名称', trigger: 'blur' },\n                ],\n                description: [\n                    { required: true, message: '请输入召集令描述', trigger: 'blur' },\n                ],\n                peopleCount: [\n                    { validator: this.check_cnt, trigger: 'blur' },\n                ],\n                endTime: [\n                    { required: true, message: '请选择召集令结束时间', trigger: 'blur'}\n                ]\n            }\n        }\n    },\n    created() {\n        var that = this\n        this.$http.get(\"/call/getCallType\", {\n                headers: {\n                    'Authorization': window.sessionStorage.getItem('token') \n                }\n        })\n        .then(function(response) {\n            if (response.data.code == 200) {\n                that.callOption = response.data.data\n            } else {\n                that.$message({showClose: true, message: response.data.message, type: 'warning'})\n            }\n        })\n        .catch(function(error) {\n            console.log(error)\n            that.$message({showClose: true, message: \"请求错误\", type: 'error'})\n        })\n    },\n    methods: {\n        // 检查召集人数\n        check_cnt(rule, value, callback) {\n            if (String(value).trim() == '') {\n                return callback(new Error('请输入召集人数'))\n            } else if (Number(value) <= 0 || Number(value) >=101) {\n                return callback(new Error('召集人数必须在1~100内'))\n            } else {\n                return callback()\n            }\n        },\n        showMessage(e) {\n            let obj = {};\n            obj = this.callOption.find((item)=>{ //这里的callOption就是上面遍历的数据源\n                return item.callTypeId === e;     //筛选出匹配数据\n            });\n            this.callForm.typeName = obj.callTypeName  // label\n            this.callForm.typeId = e            // value\n            console.log('changeOption', e, obj.callTypeName)\n        },\n        // 发布召集令\n        submit() {\n            console.log(this.callForm.endTime)\n            this.$refs.callFormRef.validate((valid) => {\n                if (!valid)\n                    return this.$message({\n                        showClose: true,\n                        message: '输入数据无效',\n                        type: 'warning',\n                    })\n\n                var config = {\n                    method: 'post',\n                    url: '/call/add',\n                    headers: { \n                        'Content-Type': 'application/json',\n                        'Authorization': window.sessionStorage.getItem('token') \n                    },\n                    data : this.callForm\n                };\n                var that = this\n                this.$http(config)\n                .then(function (response) {\n                    console.log(response.data, that.callForm.typeId, that.callForm.typeName);\n                    if (response.data.code == 200) {\n                        that.$router.push('/myconvene')\n                        window.sessionStorage.setItem('activeNav', '/myconvene')\n                        that.$store.commit('call/set_activeNav', '/myconvene')\n                        that.$message({ showClose: true, message: response.data.message,type: 'success'})\n                        that.uploadVisible = true\n                    } else {\n                        that.$message({showClose: true, message:response.data.message, type: 'error'})\n                    }\n                })\n                .catch(function (error) {\n                    console.log(error);\n                    return that.$message({showClose: true, message:'请求错误', type: 'error'})\n                });\n            })\n        },\n        // 重置\n        reset() {\n            console.log('reset convene form')\n            this.$refs.callFormRef.resetFields()\n        },\n    }\n    \n}\n</script>\n\n<style lang=\"less\" scoped>\ndiv>h2 {\n  text-align: center;\n}\n\n</style>"]}]}